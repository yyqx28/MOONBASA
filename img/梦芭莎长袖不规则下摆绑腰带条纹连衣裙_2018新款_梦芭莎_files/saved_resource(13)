(function(A){A.fn.jcarousel=function(D){return this.each(function(){new B(this,D)})};var C={vertical:false,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null};A.jcarousel=function(E,H){this.options=A.extend({},C,H||{});this.locked=false;this.container=null;this.clip=null;this.list=null;this.buttonNext=null;this.buttonPrev=null;this.wh=!this.options.vertical?"width":"height";this.lt=!this.options.vertical?"left":"top";var J="",K=E.className.split(" ");for(var F=0;F<K.length;F++){if(K[F].indexOf("jcarousel-skin")!=-1){A(E).removeClass(K[F]);var J=K[F];break}}if(E.nodeName=="UL"||E.nodeName=="OL"){this.list=A(E);this.container=this.list.parent();if(this.container.hasClass("jcarousel-clip")){if(!this.container.parent().hasClass("jcarousel-container")){this.container=this.container.wrap("<div></div>")}this.container=this.container.parent()}else{if(!this.container.hasClass("jcarousel-container")){this.container=this.list.wrap("<div></div>").parent()}}}else{this.container=A(E);this.list=A(E).find(">ul,>ol,div>ul,div>ol")}if(J!=""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1){this.container.wrap('<div class=" '+J+'"></div>')}this.clip=this.list.parent();if(!this.clip.length||!this.clip.hasClass("jcarousel-clip")){this.clip=this.list.wrap("<div></div>").parent()}this.buttonPrev=A(".jcarousel-prev",this.container);if(this.buttonPrev.size()==0&&this.options.buttonPrevHTML!=null){this.buttonPrev=this.clip.before(this.options.buttonPrevHTML).prev()}this.buttonPrev.addClass(this.className("jcarousel-prev"));this.buttonNext=A(".jcarousel-next",this.container);if(this.buttonNext.size()==0&&this.options.buttonNextHTML!=null){this.buttonNext=this.clip.before(this.options.buttonNextHTML).prev()}this.buttonNext.addClass(this.className("jcarousel-next"));this.clip.addClass(this.className("jcarousel-clip"));this.list.addClass(this.className("jcarousel-list"));this.container.addClass(this.className("jcarousel-container"));var D=this.options.visible!=null?Math.ceil(this.clipping()/this.options.visible):null;var G=this.list.children("li");var I=this;if(G.size()>0){var L=0,F=this.options.offset;G.each(function(){I.format(this,F++);L+=I.dimension(this,D)});this.list.css(this.wh,L+"px");if(!H||H.size===undefined){this.options.size=G.size()}}this.container.css("display","block");this.buttonNext.css("display","block");this.buttonPrev.css("display","block");this.funcNext=function(){I.next()};this.funcPrev=function(){I.prev()};this.funcResize=function(){I.reload()};if(this.options.initCallback!=null){this.options.initCallback(this,"init")}if(A.browser.safari){this.buttons(false,false);A(window).bind("load",function(){I.setup()})}else{this.setup()}};var B=A.jcarousel;B.fn=B.prototype={jcarousel:"0.2.3"};B.fn.extend=B.extend=A.extend;B.fn.extend({setup:function(){this.first=null;this.last=null;this.prevFirst=null;this.prevLast=null;this.animating=false;this.timer=null;this.tail=null;this.inTail=false;if(this.locked){return}this.list.css(this.lt,this.pos(this.options.offset)+"px");var D=this.pos(this.options.start);this.prevFirst=this.prevLast=null;this.animate(D,false);A(window).unbind("resize",this.funcResize).bind("resize",this.funcResize)},reset:function(){this.list.empty();this.list.css(this.lt,"0px");this.list.css(this.wh,"10px");if(this.options.initCallback!=null){this.options.initCallback(this,"reset")}this.setup()},reload:function(){if(this.tail!=null&&this.inTail){this.list.css(this.lt,B.intval(this.list.css(this.lt))+this.tail)}this.tail=null;this.inTail=false;if(this.options.reloadCallback!=null){this.options.reloadCallback(this)}if(this.options.visible!=null){var F=this;var D=Math.ceil(this.clipping()/this.options.visible),G=0,E=0;A("li",this.list).each(function(H){G+=F.dimension(this,D);if(H+1<F.first){E=G}});this.list.css(this.wh,G+"px");this.list.css(this.lt,-E+"px")}this.scroll(this.first,false)},lock:function(){this.locked=true;this.buttons()},unlock:function(){this.locked=false;this.buttons()},size:function(D){if(D!=undefined){this.options.size=D;if(!this.locked){this.buttons()}}return this.options.size},has:function(E,F){if(F==undefined||!F){F=E}if(this.options.size!==null&&F>this.options.size){F=this.options.size}for(var G=E;G<=F;G++){var D=this.get(G);if(!D.length||D.hasClass("jcarousel-item-placeholder")){return false}}return true},get:function(D){return A(".jcarousel-item-"+D,this.list)},add:function(H,K){var G=this.get(H),J=0,D=0;if(G.length==0){var E,G=this.create(H),I=B.intval(H);while(E=this.get(--I)){if(I<=0||E.length){I<=0?this.list.prepend(G):E.after(G);break}}}else{J=this.dimension(G)}G.removeClass(this.className("jcarousel-item-placeholder"));typeof K=="string"?G.html(K):G.empty().append(K);var F=this.options.visible!=null?Math.ceil(this.clipping()/this.options.visible):null;var L=this.dimension(G,F)-J;if(H>0&&H<this.first){this.list.css(this.lt,B.intval(this.list.css(this.lt))-L+"px")}this.list.css(this.wh,B.intval(this.list.css(this.wh))+L+"px");return G},remove:function(F){var E=this.get(F);if(!E.length||(F>=this.first&&F<=this.last)){return}var D=this.dimension(E);if(F<this.first){this.list.css(this.lt,B.intval(this.list.css(this.lt))+D+"px")}E.remove();this.list.css(this.wh,B.intval(this.list.css(this.wh))-D+"px")},next:function(){this.stopAuto();if(this.tail!=null&&!this.inTail){this.scrollTail(false)}else{this.scroll(((this.options.wrap=="both"||this.options.wrap=="last")&&this.options.size!=null&&this.last==this.options.size)?1:this.first+this.options.scroll)}},prev:function(){this.stopAuto();if(this.tail!=null&&this.inTail){this.scrollTail(true)}else{this.scroll(((this.options.wrap=="both"||this.options.wrap=="first")&&this.options.size!=null&&this.first==1)?this.options.size:this.first-this.options.scroll)}},scrollTail:function(D){if(this.locked||this.animating||!this.tail){return}var E=B.intval(this.list.css(this.lt));!D?E-=this.tail:E+=this.tail;this.inTail=!D;this.prevFirst=this.first;this.prevLast=this.last;this.animate(E)},scroll:function(E,D){if(this.locked||this.animating){return}this.animate(this.pos(E),D)},pos:function(L){if(this.locked||this.animating){return}L=B.intval(L);if(this.options.wrap!="circular"){L=L<1?1:(this.options.size&&L>this.options.size?this.options.size:L)}var D=this.first>L;var R=B.intval(this.list.css(this.lt));var J=this.options.wrap!="circular"&&this.first<=1?1:this.first;var E=D?this.get(J):this.get(this.last);var M=D?J:J-1;var I=null,N=0,Q=false,H=0;while(D?--M>=L:++M<L){I=this.get(M);Q=!I.length;if(I.length==0){I=this.create(M).addClass(this.className("jcarousel-item-placeholder"));E[D?"before":"after"](I)}E=I;H=this.dimension(I);if(Q){N+=H}if(this.first!=null&&(this.options.wrap=="circular"||(M>=1&&(this.options.size==null||M<=this.options.size)))){R=D?R+H:R-H}}var G=this.clipping();var F=[];var T=0,M=L,S=0;var E=this.get(L-1);while(++T){I=this.get(M);Q=!I.length;if(I.length==0){I=this.create(M).addClass(this.className("jcarousel-item-placeholder"));E.length==0?this.list.prepend(I):E[D?"before":"after"](I)}E=I;var H=this.dimension(I);if(H==0){console.log("好看，就买下吧！");/*alert("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...")*/;return 0}if(this.options.wrap!="circular"&&this.options.size!==null&&M>this.options.size){F.push(I)}else{if(Q){N+=H}}S+=H;if(S>=G){break}M++}for(var U=0;U<F.length;U++){F[U].remove()}if(N>0){this.list.css(this.wh,this.dimension(this.list)+N+"px");if(D){R-=N;this.list.css(this.lt,B.intval(this.list.css(this.lt))-N+"px")}}var O=L+T-1;if(this.options.wrap!="circular"&&this.options.size&&O>this.options.size){O=this.options.size}if(M>O){T=0,M=O,S=0;while(++T){var I=this.get(M--);if(!I.length){break}S+=this.dimension(I);if(S>=G){break}}}var K=O-T+1;if(this.options.wrap!="circular"&&K<1){K=1}if(this.inTail&&D){R+=this.tail;this.inTail=false}this.tail=null;if(this.options.wrap!="circular"&&O==this.options.size&&(O-T+1)>=1){var P=B.margin(this.get(O),!this.options.vertical?"marginRight":"marginBottom");if((S-P)>G){this.tail=S-G-P}}while(L-->K){R+=this.dimension(this.get(L))}this.prevFirst=this.first;this.prevLast=this.last;this.first=K;this.last=O;return R},animate:function(F,D){if(this.locked||this.animating){return}this.animating=true;var H=this;var G=function(){H.animating=false;if(F==0){H.list.css(H.lt,0)}if(H.options.wrap=="both"||H.options.wrap=="last"||H.options.size==null||H.last<H.options.size){H.startAuto()}H.buttons();H.notify("onAfterAnimation")};this.notify("onBeforeAnimation");if(!this.options.animation||D==false){this.list.css(this.lt,F+"px");G()}else{var E=!this.options.vertical?{"left":F}:{"top":F};this.list.animate(E,this.options.animation,this.options.easing,G)}},startAuto:function(D){if(D!=undefined){this.options.auto=D}if(this.options.auto==0){return this.stopAuto()}if(this.timer!=null){return}var E=this;this.timer=setTimeout(function(){E.next()},this.options.auto*1000)},stopAuto:function(){if(this.timer==null){return}clearTimeout(this.timer);this.timer=null},buttons:function(D,E){if(D==undefined||D==null){var D=!this.locked&&this.options.size!==0&&((this.options.wrap&&this.options.wrap!="first")||this.options.size==null||this.last<this.options.size);if(!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!=null&&this.last>=this.options.size){D=this.tail!=null&&!this.inTail}}if(E==undefined||E==null){var E=!this.locked&&this.options.size!==0&&((this.options.wrap&&this.options.wrap!="last")||this.first>1);if(!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!=null&&this.first==1){E=this.tail!=null&&this.inTail}}var F=this;this.buttonNext[D?"bind":"unbind"](this.options.buttonNextEvent,this.funcNext)[D?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",D?false:true);this.buttonPrev[E?"bind":"unbind"](this.options.buttonPrevEvent,this.funcPrev)[E?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",E?false:true);if(this.buttonNext.length>0&&(this.buttonNext[0].jcarouselstate==undefined||this.buttonNext[0].jcarouselstate!=D)&&this.options.buttonNextCallback!=null){this.buttonNext.each(function(){F.options.buttonNextCallback(F,this,D)});this.buttonNext[0].jcarouselstate=D}if(this.buttonPrev.length>0&&(this.buttonPrev[0].jcarouselstate==undefined||this.buttonPrev[0].jcarouselstate!=E)&&this.options.buttonPrevCallback!=null){this.buttonPrev.each(function(){F.options.buttonPrevCallback(F,this,E)});this.buttonPrev[0].jcarouselstate=E}},notify:function(D){var E=this.prevFirst==null?"init":(this.prevFirst<this.first?"next":"prev");this.callback("itemLoadCallback",D,E);if(this.prevFirst!==this.first){this.callback("itemFirstInCallback",D,E,this.first);this.callback("itemFirstOutCallback",D,E,this.prevFirst)}if(this.prevLast!==this.last){this.callback("itemLastInCallback",D,E,this.last);this.callback("itemLastOutCallback",D,E,this.prevLast)}this.callback("itemVisibleInCallback",D,E,this.first,this.last,this.prevFirst,this.prevLast);this.callback("itemVisibleOutCallback",D,E,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(E,F,M,H,I,J,K){if(this.options[E]==undefined||(typeof this.options[E]!="object"&&F!="onAfterAnimation")){return}var D=typeof this.options[E]=="object"?this.options[E][F]:this.options[E];if(!A.isFunction(D)){return}var L=this;if(H===undefined){D(L,M,F)}else{if(I===undefined){this.get(H).each(function(){D(L,this,H,M,F)})}else{for(var G=H;G<=I;G++){if(G!==null&&!(G>=J&&G<=K)){this.get(G).each(function(){D(L,this,G,M,F)})}}}}},create:function(D){return this.format("<li></li>",D)},format:function(E,F){var D=A(E).addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+F));D.attr("jcarouselindex",F);return D},className:function(D){return D+" "+D+(!this.options.vertical?"-horizontal":"-vertical")},dimension:function(E,D){var F=E.jquery!=undefined?E[0]:E;var G=!this.options.vertical?F.offsetWidth+B.margin(F,"marginLeft")+B.margin(F,"marginRight"):F.offsetHeight+B.margin(F,"marginTop")+B.margin(F,"marginBottom");if(D==undefined||G==D){return G}var H=!this.options.vertical?D-B.margin(F,"marginLeft")-B.margin(F,"marginRight"):D-B.margin(F,"marginTop")-B.margin(F,"marginBottom");A(F).css(this.wh,H+"px");return this.dimension(F)},clipping:function(){return !this.options.vertical?this.clip[0].offsetWidth-B.intval(this.clip.css("borderLeftWidth"))-B.intval(this.clip.css("borderRightWidth")):this.clip[0].offsetHeight-B.intval(this.clip.css("borderTopWidth"))-B.intval(this.clip.css("borderBottomWidth"))},index:function(D,E){if(E==undefined){E=this.options.size}return Math.round((((D-1)/E)-Math.floor((D-1)/E))*E)+1}});B.extend({defaults:function(D){return A.extend(C,D||{})},margin:function(D,I){if(!D){return 0}var E=D.jquery!=undefined?D[0]:D;if(I=="marginRight"&&A.browser.safari){var F={"display":"block","float":"none","width":"auto"},G,H;A.swap(E,F,function(){G=E.offsetWidth});F["marginRight"]=0;A.swap(E,F,function(){H=E.offsetWidth});return H-G}return B.intval(A.css(E,I))},intval:function(D){D=parseInt(D);return isNaN(D)?0:D}})})(jQuery);

var ML={Validator:{IsEmail:function(A){return/^[_a-zA-Z0-9\-]+(\.[_a-zA-Z0-9\-]*)*@[a-zA-Z0-9\-]+([\.][a-zA-Z0-9\-]+)+$/i.test(A)},IsMobile:function(A){return/^1[0-9][0-9]{9,9}$/i.test(A)},IsTelphone:function(A){return/(^(\d{3,4})-(\d{7,8})$)|(^(\d{3,4})-(\d{7,8})-(\d{1,4})$)/i.test(A)},IsDate:function(A){return !/Invalid|NaN/.test(new Date(A))},IsEmptyOrNull:function(A){A=$.trim(A);return A==""||A==null||A==undefined}},ValidatorStyle:{Error:function(B,A){$("#"+B).removeClass();$("#"+B).text(A);$("#"+B).addClass("validateerror")},Success:function(A){$("#"+A).removeClass();$("#"+A).html("&nbsp;");$("#"+A).addClass("validatesuccess")}}};
$(function(){var B={url:location.href,desc:"",summary:"",title:"",site:"",pics:""};var C=[];for(var A in B){C.push(A+"="+encodeURIComponent(B[A]||""))}var D="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+C.join("&");$("#qzone").attr("href",D);$(".fav_kaixin").click(function(){1;var E="http://www.kaixin001.com/repaste/share.php?rtitle="+encodeURIComponent(document.title)+"&rurl="+encodeURIComponent(document.location.href)+"&rcontent=";window.open(E);return false});$(".fav_renren").click(function(){var E="http://share.renren.com/share/buttonshare.do?link="+encodeURIComponent(document.location.href)+"&title="+encodeURIComponent(document.title);window.open(E);return false});$(".fav_sina").click(function(){var E="http://service.weibo.com/share/share.php?url="+encodeURIComponent(location.href)+"&appkey=1036638507&title="+encodeURIComponent(document.title)+"&pic=&ralateUid=1774083035";window.open(E);return false});$(".fav_qq").click(function(){var E=encodeURI("64a07d6df572437eae29939fa5a56b01");var F="http://v.t.qq.com/share/share.php?url="+encodeURIComponent(location.href)+"&title="+encodeURIComponent(document.title)+"&appkey="+E;window.open(F);return false})});
/*
 * jQzoom Evolution Library v2.3  - Javascript Image magnifier
 * http://www.mind-projects.it
 *
 * Copyright 2011, Engineer Marco Renzi
 * Licensed under the BSD license.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of the organization nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * Date: 03 May 2011 22:16:00
 */
(function($){var isIE6=($.browser.msie&&$.browser.version<7);var body=$(document.body);var window=$(window);var jqzoompluging_disabled=false;$.fn.jqzoom=function(options){return this.each(function(){var node=this.nodeName.toLowerCase();if(node=="a"){new jqzoom(this,options)}})};jqzoom=function(el,options){var api=null;api=$(el).data("jqzoom");if(api){return api}var obj=this;var settings=$.extend({},$.jqzoom.defaults,options||{});obj.el=el;el.rel=$(el).attr("rel");el.zoom_active=false;el.zoom_disabled=false;el.largeimageloading=false;el.largeimageloaded=false;el.scale={};el.timer=null;el.mousepos={};el.mouseDown=false;$(el).css({"outline-style":"none","text-decoration":"none"});var img=$("img:eq(0)",el);el.title=$(el).attr("title");el.imagetitle=img.attr("title");var zoomtitle=($.trim(el.title).length>0)?el.title:el.imagetitle;var smallimage=new Smallimage(img);var lens=new Lens();var stage=new Stage();var largeimage=new Largeimage();$(el).bind("click",function(e){e.preventDefault();return false});var zoomtypes=["standard","drag","innerzoom","reverse"];if($.inArray($.trim(settings.zoomType),zoomtypes)<0){settings.zoomType="standard"}$.extend(obj,{create:function(){if($(".zoomPad",el).length==0){el.zoomPad=$("<div/>").addClass("zoomPad");img.wrap(el.zoomPad)}if(settings.zoomType=="innerzoom"){settings.zoomWidth=smallimage.w;settings.zoomHeight=smallimage.h}if($(".zoomPup",el).length==0){lens.append()}if($(".zoomWindow",el).length==0){stage.append()}if($(".zoomPreload",el).length==0){}if(settings.preloadImages||settings.zoomType=="drag"||settings.alwaysOn){obj.load()}obj.init()},init:function(){if(settings.zoomType=="drag"){$(".zoomPad",el).mousedown(function(){el.mouseDown=true});$(".zoomPad",el).mouseup(function(){el.mouseDown=false});document.body.ondragstart=function(){return false};$(".zoomPad",el).css({cursor:"default"});$(".zoomPup",el).css({cursor:"move"})}if(settings.zoomType=="innerzoom"){$(".zoomWrapper",el).css({cursor:"crosshair"})}$(".zoomPad",el).bind("mouseenter mouseover",function(event){img.attr("title","");$(el).attr("title","");el.zoom_active=true;if(largeimage.url==""){return}smallimage.fetchdata();if(el.largeimageloaded){obj.activate(event)}else{obj.load()}});$(".zoomPad",el).bind("mouseleave",function(event){obj.deactivate()});$(".zoomPad",el).bind("mousemove",function(e){if(e.pageX>smallimage.pos.r||e.pageX<smallimage.pos.l||e.pageY<smallimage.pos.t||e.pageY>smallimage.pos.b){lens.setcenter();return false}el.zoom_active=true;if(el.largeimageloaded&&!$(".zoomWindow",el).is(":visible")){obj.activate(e)}if(el.largeimageloaded&&(settings.zoomType!="drag"||(settings.zoomType=="drag"&&el.mouseDown))){lens.setposition(e)}});var thumb_preload=new Array();var i=0;var thumblist=new Array();thumblist=$("a").filter(function(){var regex=new RegExp("gallery[\\s]*:[\\s]*'"+$.trim(el.rel)+"'","i");var rel=$(this).attr("rel");if(regex.test(rel)){return this}});if(thumblist.length>0){var first=thumblist.splice(0,1);thumblist.push(first)}thumblist.each(function(){if(settings.preloadImages){var thumb_options=$.extend({},eval("("+$.trim($(this).attr("rel"))+")"));thumb_preload[i]=new Image();thumb_preload[i].src=thumb_options.largeimage;i++}$(this).mouseover(function(e){if($(this).hasClass("zoomThumbActive")){return false}thumblist.each(function(){$(this).removeClass("zoomThumbActive")});e.preventDefault();obj.swapimage(this);return false})})},load:function(){if(el.largeimageloaded==false&&el.largeimageloading==false){var url=$(el).attr("href");el.largeimageloading=true;largeimage.loadimage(url)}},activate:function(e){clearTimeout(el.timer);lens.show();stage.show()},deactivate:function(e){switch(settings.zoomType){case"drag":break;default:img.attr("title",el.imagetitle);$(el).attr("title",el.title);if(settings.alwaysOn){lens.setcenter()}else{stage.hide();lens.hide()}break}el.zoom_active=false},swapimage:function(link){el.largeimageloading=false;el.largeimageloaded=false;var options=new Object();options=$.extend({},eval("("+$.trim($(link).attr("rel"))+")"));$(link).addClass("zoomThumbActive");var smallimage=options.smallimage;var largeimage=options.largeimage;$(el).attr("href",largeimage);img.attr("src",smallimage);lens.hide();stage.hide();if(options.smallimage&&options.largeimage){obj.load()}else{}return false}});if(img[0].complete){smallimage.fetchdata();if($(".zoomPad",el).length==0){obj.create()}}function Smallimage(image){var $obj=this;this.node=image[0];this.findborder=function(){var bordertop=0;bordertop=image.css("border-top-width");btop="";var borderleft=0;borderleft=image.css("border-left-width");bleft="";if(bordertop){for(i=0;i<3;i++){var x=[];x=bordertop.substr(i,1);if(isNaN(x)==false){btop=btop+""+bordertop.substr(i,1)}else{break}}}if(borderleft){for(i=0;i<3;i++){if(!isNaN(borderleft.substr(i,1))){bleft=bleft+borderleft.substr(i,1)}else{break}}}$obj.btop=(btop.length>0)?eval(btop):0;$obj.bleft=(bleft.length>0)?eval(bleft):0};this.fetchdata=function(){$obj.findborder();$obj.w=image.width();$obj.h=image.height();$obj.ow=image.outerWidth();$obj.oh=image.outerHeight();$obj.pos=image.offset();$obj.pos.l=image.offset().left+$obj.bleft;$obj.pos.t=image.offset().top+$obj.btop;$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;$obj.rightlimit=image.offset().left+$obj.ow;$obj.bottomlimit=image.offset().top+$obj.oh};this.node.onerror=function(){};this.node.onload=function(){$obj.fetchdata();if($(".zoomPad",el).length==0){obj.create()}};return $obj}function Loader(){var $obj=this;this.append=function(){this.node=$("<div/>").addClass("zoomPreload").css("visibility","hidden").html(settings.preloadText);$(".zoomPad",el).append(this.node)};this.show=function(){this.node.top=(smallimage.oh-this.node.height())/2;this.node.left=(smallimage.ow-this.node.width())/2;this.node.css({top:this.node.top,left:this.node.left,position:"absolute",visibility:"visible"})};this.hide=function(){this.node.css("visibility","hidden")};return this}function Lens(){var $obj=this;this.node=$("<div/>").addClass("zoomPup");this.append=function(){$(".zoomPad",el).append($(this.node).hide());if(settings.zoomType=="reverse"){this.image=new Image();this.image.src=smallimage.node.src;$(this.node).empty().append(this.image)}};this.setdimensions=function(){this.node.w=(parseInt((settings.zoomWidth)/el.scale.x)>smallimage.w)?smallimage.w:(parseInt(settings.zoomWidth/el.scale.x));this.node.h=(parseInt((settings.zoomHeight)/el.scale.y)>smallimage.h)?smallimage.h:(parseInt(settings.zoomHeight/el.scale.y));this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.css({top:0,left:0,width:this.node.w+"px",height:this.node.h+"px",position:"absolute",display:"none",borderWidth:1+"px"});if(settings.zoomType=="reverse"){this.image.src=smallimage.node.src;$(this.node).css({"opacity":1});$(this.image).css({position:"absolute",display:"block",left:-(this.node.left+1-smallimage.bleft)+"px",top:-(this.node.top+1-smallimage.btop)+"px"})}};this.setcenter=function(){this.node.top=(smallimage.oh-this.node.h-2)/2;this.node.left=(smallimage.ow-this.node.w-2)/2;this.node.css({top:this.node.top,left:this.node.left});if(settings.zoomType=="reverse"){$(this.image).css({position:"absolute",display:"block",left:-(this.node.left+1-smallimage.bleft)+"px",top:-(this.node.top+1-smallimage.btop)+"px"})}largeimage.setposition()};this.setposition=function(e){el.mousepos.x=e.pageX;el.mousepos.y=e.pageY;var lensleft=0;var lenstop=0;function overleft(lens){return el.mousepos.x-(lens.w)/2<smallimage.pos.l}function overright(lens){return el.mousepos.x+(lens.w)/2>smallimage.pos.r}function overtop(lens){return el.mousepos.y-(lens.h)/2<smallimage.pos.t}function overbottom(lens){return el.mousepos.y+(lens.h)/2>smallimage.pos.b}lensleft=el.mousepos.x+smallimage.bleft-smallimage.pos.l-(this.node.w+2)/2;lenstop=el.mousepos.y+smallimage.btop-smallimage.pos.t-(this.node.h+2)/2;if(overleft(this.node)){lensleft=smallimage.bleft-1}else{if(overright(this.node)){lensleft=smallimage.w+smallimage.bleft-this.node.w-1}}if(overtop(this.node)){lenstop=smallimage.btop-1}else{if(overbottom(this.node)){lenstop=smallimage.h+smallimage.btop-this.node.h-1}}this.node.left=lensleft;this.node.top=lenstop;this.node.css({"left":lensleft+"px","top":lenstop+"px"});if(settings.zoomType=="reverse"){if($.browser.msie&&$.browser.version>7){$(this.node).empty().append(this.image)}$(this.image).css({position:"absolute",display:"block",left:-(this.node.left+1-smallimage.bleft)+"px",top:-(this.node.top+1-smallimage.btop)+"px"})}largeimage.setposition()};this.hide=function(){img.css({"opacity":1});this.node.hide()};this.show=function(){if(settings.zoomType!="innerzoom"&&(settings.lens||settings.zoomType=="drag")){this.node.show()}if(settings.zoomType=="reverse"){img.css({"opacity":settings.imageOpacity})}};this.getoffset=function(){var o={};o.left=$obj.node.left;o.top=$obj.node.top;return o};return this}function Stage(){var $obj=this;this.node=$("<div class='zoomWindow'><div class='zoomWrapper'><div class='zoomWrapperTitle'></div><div class='zoomWrapperImage'></div></div></div>");this.ieframe=$('<iframe class="zoomIframe" src="javascript:\'\';" marginwidth="0" marginheight="0" align="bottom" scrolling="no" frameborder="0" ></iframe>');this.setposition=function(){this.node.leftpos=0;this.node.toppos=0;if(settings.zoomType!="innerzoom"){switch(settings.position){case"left":this.node.leftpos=(smallimage.pos.l-smallimage.bleft-Math.abs(settings.xOffset)-settings.zoomWidth>0)?(0-settings.zoomWidth-Math.abs(settings.xOffset)):(smallimage.ow+Math.abs(settings.xOffset));this.node.toppos=Math.abs(settings.yOffset);break;case"top":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=(smallimage.pos.t-smallimage.btop-Math.abs(settings.yOffset)-settings.zoomHeight>0)?(0-settings.zoomHeight-Math.abs(settings.yOffset)):(smallimage.oh+Math.abs(settings.yOffset));break;case"bottom":this.node.leftpos=Math.abs(settings.xOffset);this.node.toppos=(smallimage.pos.t-smallimage.btop+smallimage.oh+Math.abs(settings.yOffset)+settings.zoomHeight<screen.height)?(smallimage.oh+Math.abs(settings.yOffset)):(0-settings.zoomHeight-Math.abs(settings.yOffset));break;default:this.node.leftpos=(smallimage.rightlimit+Math.abs(settings.xOffset)+settings.zoomWidth<screen.width)?(smallimage.ow+Math.abs(settings.xOffset)):(0-settings.zoomWidth-Math.abs(settings.xOffset));this.node.toppos=Math.abs(settings.yOffset);break}}this.node.css({"left":this.node.leftpos+"px","top":this.node.toppos+"px"});return this};this.append=function(){$(".zoomPad",el).append(this.node);this.node.css({position:"absolute",display:"none",zIndex:5001});if(settings.zoomType=="innerzoom"){this.node.css({cursor:"default"});var thickness=(smallimage.bleft==0)?1:smallimage.bleft;$(".zoomWrapper",this.node).css({borderWidth:thickness+"px"})}$(".zoomWrapper",this.node).css({width:Math.round(settings.zoomWidth)+"px",borderWidth:thickness+"px"});$(".zoomWrapperImage",this.node).css({width:"100%",height:Math.round(settings.zoomHeight)+"px"});$(".zoomWrapperTitle",this.node).css({width:"100%",position:"absolute"});$(".zoomWrapperTitle",this.node).hide();if(settings.title&&zoomtitle.length>0){$(".zoomWrapperTitle",this.node).html(zoomtitle).show()}$obj.setposition()};this.hide=function(){switch(settings.hideEffect){case"fadeout":this.node.fadeOut(settings.fadeoutSpeed,function(){});break;default:this.node.hide();break}this.ieframe.hide()};this.show=function(){switch(settings.showEffect){case"fadein":this.node.fadeIn();this.node.fadeIn(settings.fadeinSpeed,function(){});break;default:this.node.show();break}if(isIE6&&settings.zoomType!="innerzoom"){this.ieframe.width=this.node.width();this.ieframe.height=this.node.height();this.ieframe.left=this.node.leftpos;this.ieframe.top=this.node.toppos;this.ieframe.css({display:"block",position:"absolute",left:this.ieframe.left,top:this.ieframe.top,zIndex:99,width:this.ieframe.width+"px",height:this.ieframe.height+"px"});$(".zoomPad",el).append(this.ieframe);this.ieframe.show()}}}function Largeimage(){var $obj=this;this.node=new Image();this.loadimage=function(url){this.url=url;this.node.style.position="absolute";this.node.style.border="0px";this.node.style.display="none";this.node.style.left="-5000px";this.node.style.top="0px";document.body.appendChild(this.node);this.node.src=url};this.fetchdata=function(){var image=$(this.node);var scale={};this.node.style.display="block";$obj.w=image.width();$obj.h=image.height();$obj.pos=image.offset();$obj.pos.l=image.offset().left;$obj.pos.t=image.offset().top;$obj.pos.r=$obj.w+$obj.pos.l;$obj.pos.b=$obj.h+$obj.pos.t;scale.x=($obj.w/smallimage.w);scale.y=($obj.h/smallimage.h);el.scale=scale;if(this.node){document.body.removeChild(this.node)}$(".zoomWrapperImage",el).empty().append(this.node);lens.setdimensions()};this.node.onerror=function(){};this.node.onload=function(){$obj.fetchdata();el.largeimageloading=false;el.largeimageloaded=true;if(settings.zoomType=="drag"||settings.alwaysOn){lens.show();stage.show();lens.setcenter()}};this.setposition=function(){var left=-el.scale.x*(lens.getoffset().left-smallimage.bleft+1);var top=-el.scale.y*(lens.getoffset().top-smallimage.btop+1);$(this.node).css({"left":left+"px","top":top+"px"})};return this}$(el).data("jqzoom",obj)};$.jqzoom={defaults:{zoomType:"standard",zoomWidth:300,zoomHeight:300,xOffset:10,yOffset:0,position:"right",preloadImages:true,preloadText:"Loading zoom",title:true,lens:true,imageOpacity:0.4,alwaysOn:false,showEffect:"show",hideEffect:"hide",fadeinSpeed:"slow",fadeoutSpeed:"2000"},disable:function(el){var api=$(el).data("jqzoom");api.disable();return false},enable:function(el){var api=$(el).data("jqzoom");api.enable();return false},disableAll:function(el){jqzoompluging_disabled=true},enableAll:function(el){jqzoompluging_disabled=false}}})(jQuery);

/*! @yanzi edited 2015-06-02 */
!function ($) { $.mola = $.extend({ addtocart: function (options) { options = $.extend({ addtype: 0, isquickadd: 0, qty: 0, warecode: "", websiteid: "", kitcode: "", kittype: "", prmcode: "", success: null, fail: null }, options || {}); var _this = this; switch (options.addtype) { case 0: $.ajax({ dataType: "jsonp", data: { Action: "AddtoCart", Qty: options.qty, WareCode: options.warecode, WebSiteId: options.websiteid }, url: ShoppingCartDomain + "/shoppinghandler.aspx", success: function (data) { "OK" != data.Status ? null !== options.fail && (data.Message ? options.fail.call(_this, data.Message) : options.fail.call(_this, data.Status)) : null !== options.success && options.success.call(_this) } }); break; case 1: $.ajax({ dataType: "jsonp", data: { PrmCode: options.prmcode, SubKitWareCodes: options.warecode, SubKitWareCount: options.qty, KitWareCode: options.kitcode }, url: ShoppingCartDomain + "/productpromote/addpromotekit", success: function (data) { "1" != data.Code ? null !== options.fail && options.fail.call(_this, data.Message) : null !== options.success && options.success.call(_this) } }); break; case 2: $.ajax({ dataType: "jsonp", data: { Action: "AddToKitCart", KitStyleId: options.kitcode, SubKitWareCodes: options.warecode, SubKitWareCount: options.qty, WebSiteId: options.websiteid, KitType: options.kittype, PrmCode: options.prmcode }, url: ShoppingCartDomain + "/shoppinghandler.aspx", success: function (data) { "OK" != data.Status ? null !== options.fail && options.fail.call(_this, data.Status) : null !== options.success && options.success.call(_this) } }); break; case 3: $.ajax({ url: ShoppingCartDomain + "/ProductPromote/AddPromote", data: { prmcode: options.prmcode, WareCode: options.warecode, Qty: options.qty }, dataType: "jsonp", jsonp: "callback", success: function (data) { "1" != data.Code ? null !== options.fail && options.fail.call(_this, data.Message) : null !== options.success && options.success.call(_this) } }) } } }, $.mola || {}), $.fn.addtocart = function (options) { this.click(function () { return $.mola.addtocart(options), !1 }) } } (jQuery);
(function ($) { $.fn.getqtyval = function () { switch (this[0].tagName) { case "SELECT": return parseInt(this.val()); case "INPUT": return parseInt(this.val()); default: return parseInt(this.text()) } }; $.fn.setqtyval = function (val) { switch (this[0].tagName) { case "SELECT": this.val(val); break; case "INPUT": this.val(val); break; default: this.text(val); break } }; $.fn.getsalemessage = function (g, iswebsale) { if (iswebsale != "1") { if (g[2] > 0) { msg = '<font style="color:#d34982;">暂时缺货预计<font style="font-size:13px;color:#ff0000;"><B>' + g[2] + "</B></font>天后到货,商品到货时我们通知您</font>" } else { msg = "暂时缺货,商品到货时我们通知您。" } } else { if (g[1] < 1) { if (g[2] > 0) { msg = '<font style="color:#d34982;">预计<font style="font-size:13px;color:#ff0000;"><B>' + parseInt(g[2]).toString() + "</B></font>天后入库，入库后立即发货</font>" } else { msg = "商品缺货" } } else { if (g[1] < 5) { if (g[1] > 0) { msg = "仅剩余" + parseInt(g[1]).toString() + "件" } else { msg = "商品缺货" } } else { msg = "现在有货" } } } return msg }; var colorsize = null; $.getcolorsize = function () { if (colorsize !== null) { return colorsize } var _colorsize = $("#hdColorSize"); if (!_colorsize[0]) { colorsize = []; return } var colorsizeval = _colorsize.val(); if (colorsizeval == "") { colorsize = []; return } colorsize = eval("(" + colorsizeval + ")"); return colorsize }; $.fn.initqty = function (_qty, _msg, _addtocart, _lost, idx, _WareDes) { var warecode = this.attr("warecode"), iswebsale = this.attr("iswebsale"), WareDes = this.attr("WareDes"); if (WareDes) { _WareDes.html("<div class='special_desc'>" + WareDes + "</div>") } else { _WareDes.html("") } var g = warecode.split(","); if (_qty[0] && _qty[0].type != "hidden") { var kc = 5; if (parseInt(g[1]) < 5) { kc = parseInt(g[1]) } _qty.data("kc", kc); _qty.setqtyval("1") } if (!_msg[0]) { return } var msg = this.getsalemessage(g, iswebsale); _msg.html(msg).data("msg", msg); var idx_ = _lost.attr("idx"); if (iswebsale != "1") { _addtocart.hide(); _lost.show(); $("#btnlostbtn").attr("warecode", g[0]); if (_lost.attr("idx") == null || idx_.indexOf(idx + "|") <= -1) { idx_ = (idx_ || "") + idx + "|"; _lost.attr("idx", idx_) } } else { _lost.attr("idx", ""); _lost.hide(); _addtocart.show() } } })(jQuery); $(function () { var presaleaddbtn = $(".presell_payment_btn"); presaleaddbtn.on("click", function (e, is_login) { if (!is_login) { isLogin(presaleaddbtn); return } $("#J_loading_dialog").dialog("open"); var container = $(this).parents("[mola-group=colorsize]"); var sizecontainer = container.find("[mola=colorsize]"); var _size = sizecontainer.find(".selon[mola=size]"); var _qty = sizecontainer.find("[mola=qty]"); var warecode = "", qty = "", allqty = 0; for (var i = 0; i < _size.length; i++) { var code = $(_size[i]).attr("warecode").split(",")[0]; var val = $(_qty[i]).getqtyval(); if (val > 0) { warecode += code + (warecode ? "|" : ""); qty += val + (qty ? "|" : ""); allqty += val } } $.get(ShoppingCartDomain + "/ShoppingHandler/ShoppingHandler?action=addpresaletocart", { "wareCode": warecode, "qty": qty }, function (r) { if (r.Code == "1") { location.href = ShoppingCartDomain + "/order/orderpresale?warecode=" + warecode + "&qty=" + qty } else { alert(r.Message) } $("#J_loading_dialog").dialog("close") }, "jsonp") }); function isLogin(_this) { $.post("/item/islogin", function (d) { if (d.Code == 1) { _this.trigger("click", 1) } else { $.mola.ifrmlogin({ loginback: function () { return }, registerback: function () { return } }) } }) } var _groupcolorsize = $("[mola-group=colorsize]"); if (!_groupcolorsize[0]) { return } var json = $.getcolorsize(); if (json == null || json.length === 0) { return } _groupcolorsize.each(function () { var _t = $(this), addtocartid = _t.data("addtocartid"), lostid = _t.data("lostid"), _addtocart = $("[mola=" + addtocartid + "]"), _lost = $("[mola=" + lostid + "]"); if (!_addtocart[0]) { return } var _colorsize = _t.find("[mola=colorsize]"); if (!_colorsize[0]) { return } _colorsize.each(function (i, v) { var _container = $(this), templateid = _container.data("templateid"), _template = $("script[mola=" + templateid + "]"); if (!_template[0]) { return } var styleid = _container.data("styleid"), template = _template.html(), data = null, attrjson = _container.data("colorsize"); if (attrjson) { json = eval("(" + attrjson + ")") } for (var j = 0; j < json.length; j++) { if (json[j].StyleCode == styleid) { data = json[j]; break } } if (data === null) { return } var over_sea = $("#hdOverseaType"); if (over_sea.length <= 0) { data.OverSea = 0 } else { data.OverSea = over_sea.val() } var x = easyTemplate(template, data); _container.html(x.toString()); var _color = _container.find("[mola=color]"), _size = _container.find("[mola=size]"), _qty = _container.find("[mola=qty]"), _add = _container.find("[mola=add]"), _rmv = _container.find("[mola=rmv]"), _msg = _container.find("[mola=msg]"); var _WareDes = _container.find("[mola=WareDes]"); _msg.data("msg", _msg.html()); _size.eq(0).initqty(_qty, _msg, _addtocart, _lost, i, _WareDes); _color.click(function () { var _this = $(this); _this.addClass("seldon").siblings().removeClass("seldon"); var color = _this.attr("color"); _size.filter(":not([color=" + color + "])").hide().end().filter("[color=" + color + "]").show().eq(0).addClass("selon").siblings().removeClass("selon"); _size.filter("[color=" + color + "]:eq(0)").initqty(_qty, _msg, _addtocart, _lost, i, _WareDes); var _ctip = _container.find("[mola=ctip]"); if (_ctip[0]) { _ctip.text(_this.attr("title")) } try { colorpic = $(this).attr("colorurl"); if (colorpic.length > 30) { $("#largeimg").bind("error", function () { $(".thurmimg").eq(0).mouseover(); $("#largeimg").unbind("error") }); $(".jcarousel-item").css("display", "none"); $(".li" + color).css("display", ""); $(".thurmimg:visible:eq(0)").mouseover(); $(".jcarousel-prev").unbind("click"); $(".jcarousel-next").unbind("click"); $("#mbscarousel").jcarousel({ vertical: false, itemFallbackDimension: 300 }).css("left", "0px"); return false } else { $(".jcarousel-item").css("display", ""); $(".thurmimg").eq(0).mouseover(); $(".jcarousel-prev").unbind("click"); $(".jcarousel-next").unbind("click"); $("#mbscarousel").jcarousel({ vertical: false, itemFallbackDimension: 300 }).css("left", "0px"); return false } } catch (e) { } }); if (_color.length > 1) { $(_color[0]).trigger("click") } _size.click(function () { var _this = $(this); _this.addClass("selon").siblings().removeClass("selon"); var idx_ = _this.attr("idx"); _this.initqty(_qty, _msg, _addtocart, _lost, idx_, _WareDes) }); if (_add[0]) { _add.click(function () { var kc = parseInt(_qty.data("kc")), qty = _qty.getqtyval(), msg = ""; if (qty === 5) { msg = "您最多只能购买5件" } else { if (qty >= kc && kc > 0) { msg = "库存不足，您只能购买" + kc.toString() + "件" } else { qty = qty + 1; _qty.setqtyval(qty.toString()) } } if (msg !== "") { _msg.html(msg) } }) } if (_rmv[0]) { _rmv.click(function () { var qty = parseInt(_qty.text()); if (qty <= 1) { return } qty = qty - 1; _qty.setqtyval(qty.toString()); _msg.html(_msg.data("msg")) }) } }); _addtocart.click(function (event, is_login) { var _this = $(this), _size = _colorsize.find(".selon[mola=size]"), _qty = _colorsize.find("[mola=qty]"); if (!_size[0]) { return } var over_sea = $("#hdOverseaType"); if (!is_login) { if (over_sea.length > 0 && (over_sea.val() == 1 || over_sea.val() == 2)) { isLogin(_this); return } } var warecode = "", qty = "", allqty = 0, isallsct = true; for (var i = 0; i < _size.length; i++) { var code = $(_size[i]).attr("warecode").split(",")[0]; var val = $(_qty[i]).getqtyval(); if (val > 0) { warecode += code + "|"; qty += val + "|"; allqty += val } } if (warecode.length === 0) { return } if (qty === "") { qty = 1 } var isgift = _colorsize.data("isgift"); if (typeof isgift == "undefined") { isgift = $("#hdIsGift").val() } if (isgift == "1") { alert("此商品为礼品，不能单独购买！"); return } var addtype = 0, kitcode = "", kittype = "", kitwareqty = "", websiteid = $("#hdWebSiteCode").val(), prmcode = "", addtype = parseInt(_this.data("addtype")), isquickadd = parseInt(_this.data("isquickadd")), addqty = 1; if (addtype != 2) { if (warecode.length > 0) { warecode = warecode.substring(0, warecode.length - 1) } if (qty.length > 0) { qty = qty.substring(0, qty.length - 1) } } switch (addtype) { case 0: addqty = allqty; break; case 1: addqty = allqty; if (qty.indexOf("|") < 0) { alert("请选择搭配套装"); return } kitcode = warecode.split("|")[0]; prmcode = _t.attr("data-" + "prmcode"); break; case 2: kitcode = _t.attr("data-" + "kitcode"), kittype = _t.data("kittype"), kitwareqty = _t.data("kitwareqty"); if (kittype == "0") { if (parseInt(kitwareqty) < allqty) { alert("此套装需要选择" + kitwareqty + "件商品"); return } } else { if (kittype == "1") { if (isallsct && parseInt(kitwareqty) < allqty) { alert("此套装需要选择" + kitwareqty + "件商品"); return } } } break; case 3: qty = 1; prmcode = _t.attr("data-" + "prmcode"); break } var options = { addtype: addtype, isquickadd: isquickadd, qty: qty, warecode: warecode, kitcode: kitcode, kittype: kittype, websiteid: websiteid, prmcode: prmcode, success: function () { if (isquickadd == 1) { window.location.href = ShoppingCartDomain; return } var _totalqty = $("[mola=totalqty]"); if (_totalqty[0]) { var totalqty = 1; if (_totalqty.length === 1) { totalqty = _totalqty.getqtyval() } else { totalqty = _totalqty.eq(0).getqtyval() } totalqty = totalqty + addqty; _totalqty.text(totalqty); var _minicart = $("[mola=minicart]"); var _refreshJudge = $("#refreshJudge"); if ((_minicart[0] || _refreshJudge[0]) && (addtype == 0 || addtype == 2)) { _minicart.data("needrefresh", "1"); $("#refreshJudge").data("needrefresh", "1") } } $(".addtocart").find(".fav,.lost").hide().end().find(".cart").show().end().dialog({ showTitle: false, showClose: false, modal: true, resizable: false, width: 800, height: 600 }) }, fail: function (message) { alert(message) } }; $.mola.addtocart(options); return false }); _lost.click(function () { $(".addtocart").find(".cart,.fav").hide().end().find(".lost").show().end().dialog({ showTitle: false, showClose: false, modal: true, resizable: false, width: 800, height: 600 }) }) }); $("#btnlostbtn").click(function () { var email = $("#txtlostemail").val(), warecode = $(this).attr("warecode"); if (!ML.Validator.IsEmail(email)) { alert("请输入正确的邮箱地址！"); return } if (typeof warecode == "undefined" || warecode == "") { alert("请选择尺码"); return } $.ajax({ url: "/Home/AddNoticeEmail7", dataType: "jsonp", jsonp: "callback", data: { Email: email, WareCode: warecode }, success: function (data) { if (data.value == "1") { alert(data.text) } else { alert(data.text) } $(".addtocart").dialog("close") } }) }) }); $(function () { var _dpkit = $(".double_list"); if (!_dpkit[0]) { return } _dpkit.each(function () { var _kit = $(this); var _prmqty = _kit.find("[mola=qty]"); var _disprice = _kit.find(".disprice"), _saleprice = _kit.find(".saleprice"), _chaji = _kit.find(".chajia"), _box1 = _kit.find(".box1"), _box2 = _kit.find(".box2"); for (var i = 0; i < _prmqty.length; i++) { if (i === 0) { $(_prmqty[i]).setqtyval("1") } else { $(_prmqty[i]).setqtyval("0"); var _cbx = $(_prmqty[i]).parent().next().children("i"); if (_cbx[0]) { _cbx.click(function () { var _cs = $(this).parent().prev(), _hdqty = _cs.find("input[mola=qty]"), disprice = parseFloat(_cs.data("disprice")), saleprice = parseFloat(_cs.data("saleprice")), tdisprice = parseFloat(_disprice.text()), tsaleprice = parseFloat(_saleprice.text()), tchajia = parseFloat(_chaji.text()); if ($(this).hasClass("click")) { $(this).removeClass("click"); _hdqty.setqtyval("0"); var a1 = tdisprice - disprice; var a2 = tsaleprice - saleprice; var a3 = a2 - a1; _disprice.text(a1.toFixed(2)); _saleprice.text(a2.toFixed(2)); _chaji.text(a3.toFixed(2)); if (a3 > 0) { _box1.show(); _box2.show() } else { _box1.hide(); _box2.hide() } } else { $(this).addClass("click"); _hdqty.setqtyval("1"); var a1 = tdisprice + disprice; var a2 = tsaleprice + saleprice; var a3 = a2 - a1; _disprice.text(a1.toFixed(2)); _saleprice.text(a2.toFixed(2)); _chaji.text(a3.toFixed(2)); if (a3 > 0) { _box1.show(); _box2.show() } else { _box1.hide(); _box2.hide() } } }) } } if ($(_prmqty[i]).val() == 0) { var _trigChose = $(_prmqty[i]).siblings().find("a"); _trigChose.click(function () { if ($(this).parents(".double_colorsize").children("[mola=qty]").val() == 0) { $(this).parents(".double_colorsize").next().children("i").click() } }) } } }) }); $(function () { $(".addtocart [mola=close]").click(function () { $(".addtocart").dialog("close"); return false }); var _fav = $("[mola=fav]"); if (!_fav[0]) { return } _fav.each(function () { var _fav = $(this), _styleid = $("#hdStyleId"); if (!_styleid[0]) { return } _fav.fav({ pid: _styleid.val(), favsucc: function (cnt) { $(".addtocart").find(".cart,.lost").hide().end().find(".fav").show().end().find(".favcnt").text(cnt).end().dialog({ showTitle: false, showClose: false, modal: true, resizable: false, width: 800, height: 600 }) } }) }) });
(function (A) { A.mola = A.extend({ ifrmlogin: function (D) { D = A.extend({ loginback: null, registerback: null, hostidx: 0 }, D || {}); if (D.hostidx == 0) { document.domain = A("#hDomain").val() } var B = D.hostidx > 0 ? "?host=" + D.hostidx : ""; A('<div id="ifrmloginDialog"><iframe src="" height="407px" width="490px" style="border:0;display:none;" frameborder="0"></iframe><span style="width:490px;height:407px;display:block;">数据努力加载中......</span></div>').hide().appendTo(A("body")); A("#ifrmloginDialog").dialog({ autoOpen: true, title: "您尚未登录", width: 510, modal: true, resizable: false }); if (A("#ifrmloginDialog iframe").attr("src") == "") { A("#ifrmloginDialog iframe").attr("src", LoginDomain + "/iframev2/login" + B) } A("#ifrmloginDialog iframe").load(function () { A(this).show().siblings("span").remove() }); if (D.loginback) { A.mola = A.extend(true, { iframe: { loginback: function () { C(); D.loginback.call(this) } } }, A.mola || {}) } if (D.registerback) { A.mola = A.extend(true, { iframe: { registerback: function () { C(); D.registerback.call(this) } } }, A.mola || {}) } function C() { A("#ifrmloginDialog").dialog("close"); A.mola.message(); A.mola.minicart() } } }, A.mola || {}); A.fn.ifrmlogin = function (B) { this.click(function () { A.mola.ifrmlogin(B) }) } })(jQuery);
(function($){$.mola=$.extend({fav:function(options){options=$.extend({pid:"",favsucc:null,url:SearchDomain+"/home/addfav",jsonp:1,hostidx:0},options||{});if(options.pid==""){return}if(options.jsonp==1){$.ajax({dataType:"jsonp",url:options.url,data:{stylecode:options.pid},success:function(str){var data=eval("("+str+")");fav(data)}})}else{$.ajax({type:"post",url:options.url,data:{stylecode:options.pid},success:function(data){fav(data)}})}function fav(_data){if(_data.rst){if(_data.rst==-2){$.mola.ifrmlogin({loginback:function(){$.mola.fav(options)},registerback:function(){$.mola.fav(options)},hostidx:options.hostidx})}else{if(_data.rst==1){if(options.favsucc!==null){options.favsucc.call(this,_data.cnt)}else{alert("收藏成功")}}else{alert(_data.msg)}}}}}},$.mola||{});$.fn.fav=function(options){var crosshost=this.attr("mola-crosshost");if(crosshost&&crosshost>0){options=$.extend(true,options,{"hostidx":crosshost})}this.click(function(){$.mola.fav(options);return false})}})(jQuery);

(function(A){A.mola=A.extend({etl:function(C){C=A.extend({analyse:1,templateid:"template",pars:null,displayid:"showelement",url:"http://etl.moonbasa.com/recommend.aspx",jsonp:1},C||{});if(C.pars==null){return}if(C.jsonp==1){A.ajax({dataType:"jsonp",url:C.url,data:C.pars,success:function(D){B(D)}})}else{A.ajax({type:"post",data:"json",url:C.url,data:C.pars,success:function(D){B(D)}})}var B=function(E){var G="";if(C.analyse==0){G=E}else{if(A("#"+C.templateid)[0]){var F=A("#"+C.templateid).html();var D=C.jsonp==1?A.parseJSON(E):E;G=easyTemplate(F,D);if(D==null||D.length==0){return}}}if(!A("#"+C.displayid)[0]){return}document.getElementById(C.displayid).style.display="block";document.getElementById(C.displayid).innerHTML=G.toString()}}},A.mola||{});A.fn.etl=function(B){B=A.extend({displayid:this[0].id},B||{});A.mola.etl(B)}})(jQuery);

var hdstylelist = ""; (function ($) { $.mola = $.extend({ repetl: function (options) { options = $.extend({ analyse: 1, templateid: "template", pars: null, displayid: "showelement", url: "http://etl.moonbasa.com/recommend.aspx", realpagesize: 5, jsonp: 1 }, options || {}); if (options.pars == null) { return } if (options.jsonp == 1) { $.ajax({ dataType: "jsonp", url: options.url, data: options.pars, success: function (str) { analyse(str) } }) } else { $.ajax({ type: "post", data: "json", url: options.url, data: options.pars, success: function (str) { analyse(str) } }) } var analyse = function (str) { var styleCode = []; var x = ""; if (options.analyse == 0) { x = str } else { if ($("#" + options.templateid)[0]) { var t = $("#" + options.templateid).html(); var data = options.jsonp == 1 ? eval("(" + str + ")") : str; var tempStyleCode = []; var hdstylecodes = hdstylelist; var arrstyle = hdstylecodes.split(","); for (var k = 0; k < arrstyle.length; k++) { tempStyleCode.push(arrstyle[k]) } for (var m = 0; m < tempStyleCode.length; m++) { for (var j = 0; j < data.length; j++) { if (data[j].styleCode == tempStyleCode[m]) { if (!Array.indexOf) { Array.prototype.indexOf = function (obj) { for (var i = 0; i < this.length; i++) { if (this[i] == obj) { return i } } return -1 } } data.splice(data.indexOf(data[j]), 1) } } } data.splice(options.realpagesize - 1, data.length - options.realpagesize); var temphdStyleCode = []; for (var j = 0; j < data.length; j++) { temphdStyleCode.push(data[j].styleCode) } var hdval = temphdStyleCode.toString(); if (hdstylecodes != "") { hdval = hdstylecodes + "," + hdval } hdstylelist = hdval; x = easyTemplate(t, data); if (data == null || data.length == 0) { return } } } if (!$("#" + options.displayid)[0]) { return } document.getElementById(options.displayid).style.display = "block"; document.getElementById(options.displayid).innerHTML = x.toString() } } }, $.mola || {}); $.fn.repetl = function (options) { options = $.extend({ displayid: this[0].id }, options || {}); $.mola.repetl(options) } })(jQuery);
$(document).ready(function (A) { var G = A("#hdStyleId").val(); var F = A("#hDomain").val(); if (F == undefined || F == "") { F = "moonbasa.com" } if (G != undefined && G != "") { G = "'" + G + "'"; var C = A.cookie("VisitedCookiesData"); if (C == null || C == "") { A.cookie("VisitedCookiesData", G, { expires: 7, path: "/", domain: F }) } else { var D = C.split(","); var B = true; for (var E = 0; E < D.length; E++) { if (D[E] == G) { D.splice(E, 1); D.unshift(G); B = false; break } } if (B) { if (D.length >= 5) { D.pop(); D.unshift(G) } else { D.unshift(G) } } A.cookie("VisitedCookiesData", D.join(), { expires: 7, path: "/", domain: F }) } } });
